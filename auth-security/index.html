<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>ğŸ” Auth & Security - Assets</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="An open-source web app where users lend assets to each other through ticket-based requests, payments, and time-limited access. Built with Django Ninja, Next.js, and PostgreSQL">
<meta name="generator" content="mkdocs-1.6.1, mkdocs-gitbook-1.0.7">
<meta name="author" content="Shahriyar Gorgany">
<link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon">
<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta rel="next" href="" />
<link href="../css/style.min.css" rel="stylesheet">
<link href="../css/extra.css" rel="stylesheet"> 
</head>

<body>
<div class="book">
<div class="book-summary">
<div id="book-search-input" role="search">
<input type="text" placeholder="Type to search" />
</div> <!-- end of book-search-input -->

<nav role="navigation">
<ul class="summary">
<li>
<a href=".." target="_blank" class="custom-link">Assets</a>
</li>
<li class="divider"></li>
<li class="chapter" data-path="">
<a href="..">ğŸ“˜ Architecture</a>
<li class="chapter" data-path="roadmap/">
<a href="../roadmap/">ğŸš€ Roadmap</a>
<li class="chapter" data-path="system-design/">
<a href="../system-design/">ğŸ§± System Design Spec</a>
<li class="chapter" data-path="api-reference/">
<a href="../api-reference/">ğŸ§© API Reference</a>
<li class="chapter active" data-path="auth-security/">
<a href="./">ğŸ” Auth & Security</a>
<li class="chapter" data-path="payment-integration/">
<a href="../payment-integration/">ğŸ’° Payment Integration</a>
<li class="chapter" data-path="database-schema/">
<a href="../database-schema/">ğŸ§® Database Schema</a>
<li class="chapter" data-path="frontend/">
<a href="../frontend/">ğŸª„ Frontend</a>
<li class="chapter" data-path="backend/">
<a href="../backend/">âš™ï¸ Backend</a>
<li class="chapter" data-path="testing/">
<a href="../testing/">ğŸ” Testing</a>
<li class="chapter" data-path="devops-deployment/">
<a href="../devops-deployment/">ğŸ§  DevOps & Deployment</a>
<li class="chapter" data-path="notifications-messaging/">
<a href="../notifications-messaging/">ğŸ“² Notifications & Messaging</a>
<li class="chapter" data-path="user-roles-permissions/">
<a href="../user-roles-permissions/">ğŸ‘¥ User Roles & Permissions</a>
<li class="chapter" data-path="dashboards-reporting/">
<a href="../dashboards-reporting/">ğŸ“ˆ Dashboards & Reporting</a>
<li class="divider"></li>



<li><a href="http://www.mkdocs.org">
Published with MkDocs
</a></li>

<li><a href="https://github.com/GitbookIO/theme-default">
Theme by GitBook
</a></li>
</ul>

</nav>

</div> <!-- end of book-summary -->

<div class="book-body">
<div class="body-inner">
<div class="book-header" role="navigation">

<!-- Title -->
<h1>
<i class="fa fa-circle-o-notch fa-spin"></i>
<a href="." ></a>
</h1>

</div> <!-- end of book-header -->

<div class="page-wrapper" tabindex="-1" role="main">
<div class="page-inner">
<div id="book-search-results">
<div class="search-noresults">

<section class="normal markdown-section">



<h1 id="auth-security">Auth &amp; Security</h1>
<h2 id="overview">Overview</h2>
<p>This document outlines the <strong>authentication, authorization, and security standards</strong> implemented in the <strong>Assets</strong> platform. The system employs <strong>OAuth 2.0</strong>, <strong>JWT-based session management</strong>, and strong encryption practices (AES-256, SHA-256) to safeguard user data and operations.</p>
<hr />
<h2 id="authentication-flow">Authentication Flow</h2>
<h3 id="1-login">1. Login</h3>
<ul>
<li>Users can authenticate using <strong>email/password</strong> or <strong>OAuth 2.0 (SSO)</strong> providers.</li>
<li>Upon successful authentication, the server issues a <strong>JWT access token</strong> and a <strong>refresh token</strong>.</li>
<li>Tokens are stored in <strong>HttpOnly cookies</strong> to prevent JavaScript access.</li>
</ul>
<h3 id="2-token-refresh">2. Token Refresh</h3>
<ul>
<li>The frontend periodically refreshes tokens using the <code>/auth/refresh/</code> endpoint before expiration.</li>
<li>Refresh tokens have a longer lifespan but can be revoked on logout or anomaly detection.</li>
</ul>
<h3 id="3-logout">3. Logout</h3>
<ul>
<li>Logout invalidates the refresh token on the server side and clears cookies in the client browser.</li>
</ul>
<h3 id="4-oauth-20-sso">4. OAuth 2.0 / SSO</h3>
<ul>
<li>The platform supports external identity providers such as <strong>Google</strong>, <strong>GitHub</strong>, and <strong>Auth0</strong>.</li>
<li>The backend validates the external providerâ€™s token and issues local JWTs for API access.</li>
<li>OAuth flow: <code>Client â†’ Provider Auth â†’ Redirect â†’ Token Exchange â†’ JWT issued</code>.</li>
</ul>
<hr />
<h2 id="authorization">Authorization</h2>
<table>
<thead>
<tr>
<th>Role</th>
<th>Permissions</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Admin</strong></td>
<td>Full access to manage users, tickets, reports, and wallets.</td>
</tr>
<tr>
<td><strong>User</strong></td>
<td>Can create and manage personal tickets, view wallet and transaction history.</td>
</tr>
</tbody>
</table>
<ul>
<li>Authorization is enforced via <strong>Django Ninja dependency injection</strong> and <strong>role-based decorators</strong>.</li>
<li>Sensitive endpoints (wallet updates, ticket actions) are double-checked with permission guards.</li>
</ul>
<hr />
<h2 id="password-management">Password Management</h2>
<ul>
<li>User passwords are stored using <strong>bcrypt</strong> hashing.</li>
<li>Password reset requests generate short-lived signed tokens with expiration limits.</li>
<li>Login attempts are rate-limited by IP and user to prevent brute-force attacks.</li>
</ul>
<hr />
<h2 id="encryption-standards">Encryption Standards</h2>
<table>
<thead>
<tr>
<th>Context</th>
<th>Algorithm</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data in Transit</strong></td>
<td>TLS 1.3</td>
<td>HTTPS between client and server</td>
</tr>
<tr>
<td><strong>Data at Rest</strong></td>
<td>AES-256-GCM</td>
<td>Encrypts wallet and personal data</td>
</tr>
<tr>
<td><strong>Password Hashing</strong></td>
<td>bcrypt</td>
<td>Stores secure salted hashes</td>
</tr>
<tr>
<td><strong>Integrity Check</strong></td>
<td>SHA-256</td>
<td>Verifies file and data integrity</td>
</tr>
</tbody>
</table>
<ul>
<li>All sensitive keys and secrets are managed through environment variables.</li>
<li>The backend supports <strong>automatic key rotation</strong> using versioned secrets.</li>
</ul>
<hr />
<h2 id="session-security">Session Security</h2>
<ul>
<li><strong>HttpOnly</strong> and <strong>Secure</strong> flags are set on cookies.</li>
<li>CSRF protection is enforced for browser-based requests.</li>
<li>CORS is limited to trusted frontend domains.</li>
<li>Session timeouts and idle logout are configurable per role.</li>
</ul>
<hr />
<h2 id="payment-security-zarinpal">Payment Security (Zarinpal)</h2>
<ul>
<li>Zarinpal API keys are stored securely via environment variables.</li>
<li>All payment callbacks are verified with Zarinpalâ€™s checksum signature.</li>
<li>Transactions use <strong>HMAC-SHA256</strong> signatures for request validation.</li>
<li>Wallet operations are <strong>atomic transactions</strong> to prevent double-spend conditions.</li>
</ul>
<hr />
<h2 id="audit-logging">Audit Logging</h2>
<p>Every sensitive operation is logged with:</p>
<ul>
<li>Timestamp and user ID</li>
<li>Request IP and method</li>
<li>Entity affected (ticket, wallet, user)</li>
<li>Action outcome (success/failure)</li>
</ul>
<p>Logs are immutable and periodically exported to an archival storage system.</p>
<hr />
<h2 id="security-testing">Security Testing</h2>
<table>
<thead>
<tr>
<th>Test Type</th>
<th>Tools</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Static Analysis</strong></td>
<td>Bandit, Ruff</td>
<td>Scans Python code for vulnerabilities</td>
</tr>
<tr>
<td><strong>Dependency Audit</strong></td>
<td>Safety</td>
<td>Checks for known CVEs in libraries</td>
</tr>
<tr>
<td><strong>Penetration Testing</strong></td>
<td>OWASP ZAP</td>
<td>Simulates common attacks (XSS, CSRF, SQLi)</td>
</tr>
<tr>
<td><strong>Load Testing</strong></td>
<td>Locust</td>
<td>Evaluates performance under concurrent access</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="compliance-and-best-practices">Compliance and Best Practices</h2>
<ul>
<li>GDPR-aligned data handling and deletion workflows.</li>
<li>Encryption keys and tokens never committed to version control.</li>
<li>Security patches and dependencies updated via automated CI pipelines.</li>
<li>Regular backup rotation and integrity checks.</li>
</ul>
<hr />
<h2 id="incident-response">Incident Response</h2>
<ol>
<li>Detect â†’ Monitor logs and alerts for anomalies.</li>
<li>Contain â†’ Disable affected tokens, isolate endpoints.</li>
<li>Eradicate â†’ Patch vulnerabilities and rotate secrets.</li>
<li>Recover â†’ Restore service and notify stakeholders.</li>
<li>Review â†’ Conduct post-mortem and update policies.</li>
</ol>


</section>
</div> <!-- end of search-noresults -->
<div class="search-results">
<div class="has-results">

<h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
<ul class="search-results-list"></ul>

</div> <!-- end of has-results -->
<div class="no-results">

<h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>

</div> <!-- end of no-results -->
</div> <!-- end of search-results -->
</div> <!-- end of book-search-results -->

</div> <!-- end of page-inner -->
</div> <!-- end of page-wrapper -->

</div> <!-- end of body-inner -->

</div> <!-- end of book-body -->
<script src="../js/main.js"></script>
<script src="../search/main.js"></script>
<script src="../js/gitbook.min.js"></script>
<script src="../js/theme.min.js"></script>
</body>
</html>